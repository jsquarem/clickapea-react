import React, { useState } from 'react';
import ErrorMessage from '../../components/ErrorMessage/ErrorMessage';
import { useEffect } from 'react';
import IngredientList from '../../components/IngredientList/IngredientList';
import RecipeImage from '../../components/RecipeImage/RecipeImage';
import RecipeExtras from '../../components/RecipeExtras/RecipeExtras';
import EquipmentList from '../EquipmentList/EquipmentList';
import RecipeInstructions from '../RecipeInstructions/RecipeInstructions';
import AddToRecipeBookButton from '../AddToRecipeBookButton/AddToRecipeBookButton';

export default function RecipeCard({ recipeObject }) {
  const [recipe, setRecipe] = useState(null);
  const [ingredients, setIngredients] = useState(null);
  const [recipeImage, setRecipeImage] = useState(null);
  const [recipeExtras, setRecipeExtras] = useState(null);
  const [recipeName, setRecipeName] = useState(null);
  const [equipmentList, setEquipmentList] = useState(null);
  const [recipeInstructions, setRecipeInstructions] = useState(null);
  const [recipeID, setRecipeID] = useState(recipeObject.recipe._id);
  // console.log(recipeObject, '<-recipeObject');

  // useEffect(() => {
  //   setRecipe(recipeObject.recipe);
  // }, []);

  useEffect(() => {
    if (recipe) {
      setIngredients(recipe.extendedIngredients);
      setRecipeImage(recipe.image);
      setRecipeName(recipe.title);
      setEquipmentList(recipe.equipment);
      setRecipeInstructions(recipe.analyzedInstructions[0].steps);
      setRecipeExtras({
        preparationMinutes: recipe.preparationMinutes,
        cookingMinutes: recipe.cookingMinutes,
        readyInMinutes: recipe.readyInMinutes,
        vegetarian: recipe.vegetarian,
        vegan: recipe.vegan,
        glutenFree: recipe.glutenFree,
        dairyFree: recipe.dairyFree,
        veryHealthy: recipe.veryHealthy,
        taste: recipe.taste,
      });
      // setRecipeID(recipe._id);
      console.log(recipeID, '<-recipeID');
    } else {
      setRecipe(recipeObject.recipe);
    }
  }, [recipe]);
  console.log(recipeObject, '<-recipeObject in recipecard');

  return (
    <>
      <div className="row">
        <div className="col-12">
          <div className="row">
            <div className="col-6">
              <h2 className="text-center pt-2">{recipeName}</h2>
            </div>
            <div className="col-6">
              <AddToRecipeBookButton />
            </div>
          </div>
        </div>
        <div className="col-12 col-md-6">
          <RecipeImage recipeImage={recipeImage} />
        </div>
        <div className="col-12 col-md-6">
          {ingredients ? <IngredientList ingredients={ingredients} /> : ''}
          {recipeExtras ? <RecipeExtras recipeExtras={recipeExtras} /> : ''}
        </div>
      </div>
      <div className="row">
        {equipmentList ? <EquipmentList equipmentList={equipmentList} /> : ''}
      </div>
      <div className="row">
        {recipeInstructions ? (
          <RecipeInstructions recipeInstructions={recipeInstructions} />
        ) : (
          ''
        )}
      </div>
    </>
  );
}
